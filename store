stage ("Execute Ansible Playbook") {
           steps {
               script{
                   echo "Calling ansible playbook to configure ec2 instances"
                   //INSTALL SSH PIPELINE STEPS PLUGIN IN JENKINS CI SERVER
                   def remote = [:]
                   remote.name = "ec2-user"
                   remote.host = env.ANSIBLE_SERVER
                   remote.allowAnyHosts = true
                   withCredentials ([sshUserPrivateKey(credentialsId: '', keyFileVariable: 'keyfail', usernameVariable: 'user')])
                      remote.user = user
                      remote.identityFile = keyFile
                      sshScript remote: remote, script: "ansible-script.sh"
                      sshCommand remote: remote, command: "ansible-playbook playbook.yaml" 
                    } 
                   
               }

           }